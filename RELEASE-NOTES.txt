DigiDoc4J Java library release notes
------------------------------------

Release 5.3.2
-------------
EU and its member states are expected to transition to version 6 of the EU Trust List format in the second half of May 2025.

DigiDoc4j version 5.x.x users must upgrade to DigiDoc4j version 5.3.2 or 6.0.1 before EU member states adopt EU Trust List version 6.
If the upgrade is not done, it won't be possible to load EU Trust Lists, which results in failure on signature creation and validation.

Separate info will be provided for older versions, though we strongly recommend upgrading to the latest version.

Summary of the major changes since 5.3.1
----------------------------------------
* Updated DSS to 6.0.1 (sd-dss 6.0.1.d4j.1). Check changes in DSS here: https://github.com/esig/dss/releases/tag/6.0.1
  - Added support for EU Trust List v6; EU Trust List v5 remains supported
* Fixes and improvements to unit tests
* Updated dependencies

Known issues
------------
* We have noticed a decrease in performance of parsing/validating XAdES signatures that cover numerous data files since updating to DSS 6.0
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)

Release 5.3.1
------------------
Summary of the major changes since 5.3.0
------------------------------------------
* Updated DSS to 6.0.d4j.2 in order to fix memory leak issue in XAdESSignature
* Updated Bouncy Castle to 1.78.1
* Fixed/updated unit tests

Known issues
------------
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)

Release 5.3.0
------------------
Summary of the major changes since 5.2.0
------------------------------------------
* DSS version update to 6.0 (sd-dss.6.0.d4j.1), previously used DSS 5.11.1. Check changes in DSS here: https://github.com/esig/dss/releases
  DSS update has caused the following notable changes to dependencies:
  - Migration from Javax to Jakarta namespace
  - JAXB dependencies updated from 2.3.X to 3.0.X
  - Apache Santuario xmlsec updated from 2.3.X to 3.0.X
  - Bouncy Castle updated from jdk15on:1.70 to jdk18on:1.76
  - SLF4J updated from 1.7.X to 2.0.X
* Prefer to use AIA OCSP by default on signature creation
  - In DigiDoc4J command line utility, deprecated -aiaocsp parameter and added new -noaiaocsp parameter
* TEST mode default timestamp URL updated to http://tsa.demo.sk.ee/tsa
* Changes in validation policies
* Updated dependencies

Known issues
------------
* EDIT 10.06.2024: NB! Underlying DSS library version used in this release has memory leak since DSS 5.13.RC1.
* At the time of release, the newest supported Bouncy Castle version is 1.76
  Bouncy Castle version 1.77 causes OCSP response parsing to fail
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)

Release 5.2.0
------------------
Summary of the major changes since 5.1.0
------------------------------------------
* Disabled the possibility to create signatures with LT_TM and B_EPES profiles
* Fixed OCSP request nonce encoding (in CommonOCSPSource) on signature creation - OCSP nonce, used in
  "id-pkix-ocsp-nonce" OCSP extension, is now a DER-encoded OCTET STRING, which is encapsulated as another OCTET STRING
  (see https://www.rfc-editor.org/rfc/rfc4366.html#section-3.6 and https://www.rfc-editor.org/rfc/rfc6961.html#section-2.2)
* Deprecated "full report" configuration flag, as enabling it can produce false negative validation results in some cases:
  - Deprecated setFullReportNeeded and isFullReport needed methods in Configuration class
  - Deprecated -err/-showerrors command line option in DigiDoc4J command line utility
* Updated dependencies

Known issues
------------
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 5.1.0
------------------
Summary of the major changes since 5.0.0
------------------------------------------
* DSS version update to 5.11.1 (sd-dss.5.11.1.d4j.1), previously used DSS 5.9. Check changes in DSS here: https://github.com/esig/dss/releases
  - identification of timemark signatures was improved in DSS
* The functionality to add timestamp tokens to ASiC-S containers was deprecated and will be removed in the future
* Added default TLS configuration for outbound connections in default "digidoc4j.yaml" and "digidoc-test.yaml" files
  - default TLS protocol: TLSv1.3
  - supported protocols: TLSv1.2 ja TLSv1.3
  - configured a set of enabled TLSv1.2 and TLSv1.3 cipher suites
* Improved META-INF/manifest.xml file creation for ASiC containers
  - the manifest tag in newly create ASiC containers now has a version attribute with value "1.2"
* Deprecated input parsing constructors of ASiC container classes - it is encouraged to use ContainerOpener and ContainerBuilder instead
* API improvements:
  - added possibility to configure custom AIA sources (via AIA source factories)
  - deprecated possibility to configure AIA data loaders (via AIA data loader factories)
* Dependencies update

Known issues
------------
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 5.0.0
------------------
Summary of the major changes since 4.3.0
------------------------------------------
* DSS version update to 5.9 (sd-dss.5.9.d4j.1), previously used DSS 5.8. Check changes in DSS here: https://github.com/esig/dss/releases
* Pivot LOTL support (https://ec.europa.eu/tools/lotl/pivot-lotl-explanation.html):
  - pivot LOTL support is enabled by default for PROD mode
  - pivot LOTL support is configurable via Configuration.setLotlPivotSupportEnabled(boolean) and LOTL_PIVOT_SUPPORT_ENABLED configuration parameter
* Improved digest algorithm selection:
  - signature digest algorithm and datafile digest algorithm are separately configurable
  - for ECC signatures, the default signature digest algorithm depends on the key length
* Changes in handling the encoded datafile names in signatures:
  - a '+' sign in an encoded data file name is decoded as '+' instead of a whitespace
* TSL loading default connection and socket timeouts increased to 1 minute
* TSL refresh callbacks. More information can be found here: https://github.com/open-eid/digidoc4j/wiki/Questions-&-Answers#tsl-refresh-callbacks-since-version-500
* Separate configurability for HTTP and HTTPS proxy user and password
* Refactoring of LOTL configuration API (Configuration class and YAML configuration parameters):
  - added setLotlLocation(String) and getLotlLocation() methods, LOTL_LOCATION parameter (deprecated setTslLocation(String), getTslLocation() and TSL_LOCATION)
  - added setLotlTruststorePath(String) and getLotlTruststorePath(String) methods, LOTL_TRUSTSTORE_PATH parameter (deprecated setTslKeyStoreLocation(String), getTslKeyStoreLocation() and TSL_KEYSTORE_LOCATION)
  - added setLotlTruststorePassword(String) and getLotlTruststorePassword() methods, LOTL_TRUSTSTORE_PASSWORD parameter (deprecated setTslKeyStorePassword(String), getTslKeyStorePassword() and TSL_KEYSTORE_PASSWORD)
  - added setLotlTruststoreType(String) and getLotlTruststoreType() methods, LOTL_TRUSTSTORE_TYPE parameter (set the default to "PKCS12" instead of "JKS")
* Removal of old API-s that were deprecated before the version 4.0.0; an inconclusive list of removed public API-s:
  - methods removed from Configuration class:
    - void enableBigFilesSupport(long)
    - boolean isBigFilesSupportEnabled()
  - methods removed from Container interface and its implementing classes:
    - void addRawSignature(byte[])
    - void addRawSignature(InputStream)
    - int countDataFiles()
    - int countSignatures()
    - void extendTo(SignatureProfile)
    - DataFile getDataFile(int)
    - DigestAlgorithm getDigestAlgorithm()
    - DocumentType getDocumentType()
    - Signature getSignature(int)
    - String getSignatureProfile()
    - String getVersion()
    - SignedInfo prepareSigning(X509Certificate)
    - void removeDataFile(String)
    - void removeSignature(int)
    - void save(String)
    - void setSignatureParameters(SignatureParameters)
    - void setSignatureProfile(SignatureProfile)
    - Signature signRaw(byte[])
    - Signature sign(SignatureToken)
  - methods removed from Signature interface and its implementing classes:
    - String getPolicy()
    - Date getProducedAt()
    - byte[] getRawSignature()
    - URI getSignaturePolicyURI()
    - Date getSigningTime()
    - List<DigiDoc4JException> validate()
  - DigestDataFile(String, DigestAlgorithm, byte[]) constructor without mimetype
  - Signer interface and PKCS12Signer class
* Removal of custom TSL TLS trust-store:
  - by default, Java TLS trust-store is used for both PROD and TEST modes
  - no custom TSL TLS trust-store is shipped with DigiDoc4J library
* DataFile digest calculation and memory usage improvements:
  - reduction of making redundant in-memory copies of the contents of datafiles
  - improved calculation and caching of digest values
* Dependencies update

Known issues
------------
* We have noticed a slight increase in TSL loading times due to pivot LOTL support
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.3.0
------------------
Summary of the major changes since 4.2.2
------------------------------------------
* DSS version update to 5.8 (sd-dss.5.8.d4j.1), previously used DSS 5.7. Check changes in DSS here: https://github.com/esig/dss/releases
* CommonOCSPSource improvements of building certificate chain from OCSP certificate to trust anchor in TSL
* ContainerBuilder thread-safety improvements
* TSL TLS truststore update
* Dependencies update

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.2.2
------------------
Summary of the major changes since 4.2.1
------------------------------------------
* Update LOTL signer certificates' truststore
* Update TSL TLS truststore
* Update org.apache.santuario:xmlsec dependency

Known issues
------------
* ContainerBuilder instances share mutable state which may cause unexpected behaviour while concurrently using multiple ContainerBuilder instances which have been created for different container types. This problem have been present since version 2.0.0 but may be more problematic after version 3.1.1.
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.2.1
------------------
Summary of the major changes since 4.2.0
------------------------------------------
* ZIP-bombing detection improvements and configurability
* Upgrade of TSL TLS truststore
* Dependencies update

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 4.2.0
------------------
Summary of the major changes since 4.1.1
------------------------------------------
* ZIP-bomb attack protection
* If not specified, create ASiC-E (instead of BDOC) containers by default
* Search BDOC TM signature OCSP certificate from OCSP token first and then from the unsigned properties of the signature
* Limitations for empty (0-byte) datafiles:
  - Adding empty datafiles to containers is not permitted; signing containers containing empty datafiles is not permitted
  - Validating containers containing empty datafiles adds additional container warnings
* Changes in validation policies
* Upgrade of TSL TLS truststore
* Dependencies update
* Bug fixes

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 4.1.1
------------------
Signer certificate for the EU List of eIDAS Trusted Lists (LOTL) was changed on 25.03.2021. This resulted in failure to sign or validate signatures with DD4J version 4.1.0.
Current version of DD4J (4.1.1) must be used to ensure that signing and signature validation works.
It is also possible to create a new custom keystore according to https://github.com/open-eid/digidoc4j/wiki/Questions-&-Answers#how-to-add-trust-for-new-eu-tsl-signing-certificates.

Summary of the major changes since 4.1.0
------------------------------------------
* Updated LOTL signer certificates in truststore

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 4.1.0
------------------
Summary of the major changes since 4.1.0-RC.1
------------------------------------------
* Added PolicyImplied policy support - now defaults to standard validation procedure
* Added validity verification of timestamp and OCSP certificate when creating signatures
* Fixed OCSP revocation validation
* Upgrade of TSL TLS truststore

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 4.1.0-RC.1
------------------
Summary of the major changes since 4.0.3
------------------------------------------
* Started to use DSS version 5.7 (sd-dss.5.7.d4j.1), previously used DSS 5.5 - BouncyCastle version 1.65 is recommended. Check changes in DSS here: https://github.com/esig/dss/releases
* Upgrade of dependencies
* Upgrade of TSL TLS truststores
* Failure to load or validate LOTL is only loged. No exception is thrown.
* LOTL and TSL are kept and used in memory until their nextUpdate expiration. Resolves problem where TSL is not available at refresh.
* Removed OCSP RevocationDataAvailable parameter from default constraint.
* Only qualifed TimeStamps are accepted in validation (QTST identifier must be present in TSL).
* Deleted unnecessary Intellij project files
* Removed ability to create hashcode LTA signatures
* New default test OCSP responder - TEST of SK OCSP RESPONDER 2020
* Changed TSLCertificateSource interface

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 4.0.3
------------------
Bug fixes
------------------------------
* Fix retrieval of data files from DDOC 1.0 when in-memory caching is used

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* BouncyCastle versions 1.64 and up are not supported when validating signatures containing encapsulated CRL data
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");
* DIGIDOC_MAX_DATAFILE_CACHED parameter does not work correctly for DDOC because the value is compared as bytes instead of MB

Release 4.0.2
------------------
Summary of the major changes since 4.0.1
------------------------------------------
* Update TSL truststore:
    - Addition of new CA certificate for Estonian (EE) TSL SSL that will be used from October 2020.
    - Update of certificates to fix Belgian (BE), Portuguese (PT), Italian (IT), and Romanian (RO) TSL loading
* Update of default trusted territories to enable TSL loading:
    - Enable Croatia (HR) and Germany (DE)
    - Change Greece country code from GR to EL

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* BouncyCastle versions 1.64 and up are not supported when validating signatures containing encapsulated CRL data
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.0.1
------------------
Summary of the major changes since 4.0.0
------------------------------------------
* Added implementation for getOCSPNonce() method in Signature

Bug fixes
------------------------------
* Fixed getSignatureMethod() for BES signature to use SignatureAlgorithm instead of DigestAlgorithm
* Fixed HASHCODE support for DDOC 1.0

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* BouncyCastle versions 1.64 and up are not supported when validating signatures containing encapsulated CRL data
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.0.0
------------------
Summary of the major changes since 4.0.0-RC.1
----------------------------------------------
* Removal of system information being exposed via User-Agent (zip comments and request headers)
* Enforcement of ASiC/BDOC "mimetype" always being the first entry and not compressed on re-saving an existing container
* Addition of default HTTP redirect-supporting data loader for accessing AIA certificate sources
* Removal of unnecessary logging dependencies
* Dependencies update

Known issues
------------
* We have noticed a decrease in performance with the introduction of properly accessing AIA certificate resources
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* BouncyCastle versions 1.64 and up are not supported when validating signatures containing encapsulated CRL data
* While upgrading from versions older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 4.0.0-RC.1
------------------
NB! 4.0.0-RC.1 introduces breaking changes compared to 3.x.x version. Substantial changes may be further introduced before finalization of version 4.0.0.

Summary of the major changes since 3.3.0
------------------------------------------
* Required minimum Java version increased to 8
* Started to use DSS version 5.5 (sd-dss.5.5.d4j.1)
* Enabled SSL certificate validation enforcement + added default TSL truststore for PROD mode
  - when using custom digidoc4j.yaml and default TSL in PROD mode, the usage of the default TSL truststore must be configured in digidoc4j.yaml
* Improved configurability of SSL settings, added possibility to configure SSL and proxy settings separately for TSL, OCSP and TSP
* Additional checks for XAdES signature validation:
  - if present, timestamp must be taken during the validity period of the signing certificate
  - if present, timestamp must be taken before or at the same time as OCSP
* API improvements:
  - possibility to add custom data loaders for TSL loading, OCSP and TSP requests
  - possibility to listen to OCSP and TSP events when using default data loaders
* Reduced logging of personal information at INFO level
* Dependencies update

Bug fixes (inconclusive list):
------------------------------
* Ensure that signature creation fails if making an OCSP request is not possible
* Allow signatures with different signature digest algorithm and data files digest algorithm to correctly validate
* Always re-validate a container when asked for a container validation result in order to avoid returning stale results in case the container has been updated since last validation
* Removed creation of temporary TSL keystore files that were never deleted

Known issues
------------
* We have noticed a decrease in performance with new DSS 5.5 version
* Opening a container that contains signatures, triggers TSL loading (TSL lazy loading does not work as expected)
* BouncyCastle versions 1.64 and up are not supported when validating signatures containing encapsulated CRL data
* While upgrading from version older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK7u40+, JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 3.3.0
------------------
Summary of the major changes since 3.2.0
------------------------------------------
* Default LOTL location update
* Depracate currect method for DigestDataFile creation. Addition of obligatory mimeType setting.
* Fix of removeDataFile functionality
* Dependencies update

Release 3.2.0
------------------
Summary of the major changes since 3.1.1
------------------------------------------
* DataToSign serialization improvements
* Added two-step signing option without Container nor DataToSign object serialization. Container can be saved to disk and only SignatureParameters has to be serialized. Later one can finalize signature with SignatureFinalizer which is initialized from the loaded Container and deserialized SignatureParameters.
* OCSP and TSA services requests error handling changes - more logical exceptions and stopping of signing process in case of any fault
* Removal of unnecessary logging
* Dependencies update

Release 3.1.1
------------------
Summary of the major changes since 3.1.0
------------------------------------------
* Fix for BDOC/ASIC-E container detection - NB! it is not possible to add LT_TM (TimeMark) signatures to ASIC-E container (container that contains only Time Stamp based signatures).
* Fix for not able to remove signatures from ASIC-E container
* Performance improvement
* New LOTL signer certs added to truststore

Known issues
------------
* While upgrading from version older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK7u40+, JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");


Release 3.1.0
------------------
Summary of the major changes since 3.0.0
------------------------------------------
* Started to use DSS version 5.4 (sd-dss.5.4.d4j.1)
* AIA OCSP usage for ASIC-E containers
* Upgrade of dependencies
* Bug fixes (inconclusive list):
  - PDF validation fix
  - ASIC-S container creation fix
  - JAVA 7 support for truststore
  - TimeStamp url logging fix
  - Fixes in DD4J utility for PDF validation

Known issues
------------
* We have noticed a decrease in performance with new DSS 5.4 version. Performance test results can be found here.
* While upgrading from version older than 2.1.1 be sure that your integration :
  - doesn't use Xalan or XercesImpl dependencies
  - uses a patched Java version (JDK7u40+, JDK8 or higher)
    Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
    If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 3.0.0
------------------
Summary of the major changes since 2.1.1
------------------------------------------
* Refactor of jDigidoc into DDOC4J module. Only DDOC validation is now supported, all other functionality removed!
* PKCS11 slot selection with label
* Possibility to sign and validate detached XAdES signatures
* OCSP check for TM suitability
* Enabling LOTL validation constraints
* Bug fixes (incoclusive list):
- Fix for loosing configuration during serialization/deserialization
- Changes in DDOC error handling
- Support for old DDOC formats (1.0, 1.1)
- Fixes in digidoc4j utility

Known issues
------------
* PDF validation always returns invalid status
* Creating ASIC-S containers produces non standard containers
* AIA OCSP usage not supported

While upgrading, be sure that your integration :
* doesn't use Xalan or XercesImpl dependencies
* uses a patched Java version (JDK7u40+, JDK8 or higher)
Xalan and XercesImpl were used to patch XML vulnerabilities in older java versions. They should be discarded with higher versions because they override default Java XML security.
If it is not possible to remove Xalan, then you can set your system property to override TransformerFactory : System.setProperty("javax.xml.transform.TransformerFactory","com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl");

Release 2.1.1
------------------
Summary of the major changes since 2.1.0
------------------------------------------
* Updated dependency libraries to latest versions for security purposes
* Started to use DSS version 5.2.1 (sd-dss.5.2.d4j.4).

Release 2.1.0
------------------
Summary of the major changes since 2.0.1.RC.1
------------------------------------------
* Corrected validation of ASiC-E with implicit signature policy and TimeStamp
* Corrected error messages for integration tests
* Corrected support for trusted lists eIDAS parameters (TLWellSigned etc)
* Ensured that signature will not contain empty SignerRole tag

Release 2.1.0.RC.1
------------------
Summary of the major changes since 2.0.1
------------------------------------------
* Started to use DSS version 5.2 (sd-dss.5.2.d4j.3).
* Support to validate user certificate via OCSP has been added

Release 2.0.1
------------------
Summary of the major changes since 2.0.0
------------------------------------------
* In unit-tests the expired keys are replaced
* Unit-test for digidoc4j-util are fixed
* Added functionality for digidoc4j-util in order to test external signing

Release 2.0.0
------------------
Summary of the major changes since 2.0.0.RC.2
------------------------------------------
* Unit-test are refactored.

Release 2.0.0.RC.2
------------------
Summary of the major changes since 2.0.0.RC.1
------------------------------------------
* Added support for TLWellSigned parameter.
* Some refactoring in Signature classes and utilities.

Release 2.0.0.RC.1
------------------
Summary of the major changes since 1.0.8.beta.2
------------------------------------------
* Start of using semantic versioning (1.0.8 --> 2.0.0)
* Fixed validation of containers where mime type has wrong format.
* Added check that at least one data file is present before signing.
* Ensured that SignaturePolicyImplied element is not allowed in TM signatures.

Release 1.0.8.beta.2
------------------
Summary of the major changes since 1.0.8.beta.1
------------------------------------------
* Fixed signing with ID-card and using PKCS11SignatureToken when encryption algorithm is ECDSA and RSA.

------------------------------------------
Release 1.0.8.beta.1
------------------
Summary of the major changes since 1.0.7.2
------------------------------------------
* Started to use DSS version 5.1 (sd-dss.5.1.d4j.5).
* Added support for removing signature from container.
* Added support for creating, timestamping and validating the ASiCS containers.
* Added support for validating PADES containers (PDF-files with signature).
* Major refactoring of code
  - classes from package org.digidoc4j.impl.bdoc are now in org.digidoc4j.impl.asic.asice.bdoc;
  - the common functionality for ASiCE, ASiCS and BDOC are in package org.digidoc4j.impl.asic;
  - the common functionality for ASiCE and BDOC are in package org.digidoc4j.impl.asic.asice;
  - method DataToSign.getDigestToSign() is renamed to DataToSign.getDataToSign().
* Added new API methods for accessing signature validation details.
* Added support for BDOC validation warning when SHA-1 is used.
* Documentation (github wiki, javadoc in github) is updated.

Known issues
------------
* Signing with ID-card and using PKCS11SignatureToken class have still a problem
when encryption algorithm is ECDSA. We are working on it.

------------------------------------
Release 1.0.7.2
------------------
Summary of the major changes since 1.0.7.1
------------------------------------------
* Prevent XXE(XML External Entity) processing (switching to sd-dss-5.0.d4j.5).

------------------------------------
Release 1.0.7.1
------------------
Summary of the major changes since 1.0.7
----------------------------------------
* Fixed signing problem when encryption algorithm is ECDSA and signature profile LT_TM.
* Updated the pre-calculated policy digest value.

Known issues
------------
* Signing with ID-card and using PKCS11SignatureToken class have still a problem
when encryption algorithm is ECDSA and signature profile LT_TM.

------------------------------------
Release 1.0.7
------------------
Summary of the major changes since 1.0.7 RC.2
----------------------------------------
* Performance test fix

------------------------------------
Release 1.0.7 RC.2
------------------
Summary of the major changes since 1.0.7 RC.1
----------------------------------------
* BDocSignatureBuilder class has two new parameters - DEFAULT_SIGNATURE_PROFILE
  and DEFAULT_SIGNATURE_DIGEST_ALGORITHM
* Fixed problem with missing jar's in digidoc4j-*-library.zip

Release 1.0.7 RC.1
------------------
Summary of the major changes since 1.0.7 Beta.2
----------------------------------------
* Fixed problem with OCSP responds where responseID is keyhash instead of name
* Removed logback.xml from jar file, it is needed only for digidoc4j-util
* Fixed problem in opening of DDOC files over stream parameter [#134342153]
* Added ability to configure network proxy and SSL settings through JVM parameters [#129040397]

Release 1.0.7 Beta.2
--------------------
Summary of the major changes since 1.0.7 Beta.1
----------------------------------------
* Changed TSL URL for Test mode
* Fixed problem with URI encoding for libdigidocpp
* Fixed problem with newline symbol in signature policy ID value
* In order to generate DSS validation reports the option '-r <reportDir>' for digidoc4j-util is added

Release 1.0.7 Beta.1
--------------------
Summary of the major changes since 1.0.6
----------------------------------------
* Started to use DSS version 5.0

Release 1.0.6
--------------------
There are no major changes since 1.0.6 RC.1
----------------------------------------

Release 1.0.6 RC.1
--------------------
Summary of the major changes since 1.0.6 Beta.2
----------------------------------------
* Project building system is now Maven

Release 1.0.6 Beta.2
--------------------
Summary of the major changes since 1.0.6 Beta.1
----------------------------------------
* Cleaned up repository and removed some unnecessary files [#114205179]
* API methods return empty object or exception instead of null where possible [#123022761]
* Reverted Bouncycastle libraries to version 1.54

Release 1.0.6 Beta.1
--------------------
Summary of the major changes since 1.0.5
----------------------------------------
* Updated dependency libraries to latest versions [#120674723]
* Corrected error message in case of invalid DDOC file [#125515091]
* Added support for restricting special characters in data file names [#130206233]
* Reviewed and fixed unit tests where possible [#111599596]
* Signature getSigningTime returns trusted time (or computer time for BES) [#133662737]
* Writing Container directly to OutputStream [#133095765]
* Added changes to ignore some DDOC XML-file errors [#134342153]
* Validating Latvia xades signatures ocsp and timestamp diff [#128099395]
* Fixed invalid validation: EDOC 2.0 / SHA-256 signature: TimeStamp before OCSP-d.

Release 1.0.5
--------------------
Summary of the major changes since 1.0.4
----------------------------------------
* Implemented parallel validation of signatures in a container for better performance [#113606559]
* Added support for extending EPES signature to LT_TM profile [#130718495]
* Added support for CVC concatenated signature format for ECDSA signatures [#121930867]
* Added support for automatically determining if ECC signature algorithm [#121839585]
* Added support for setting SSL KeyStore and TrustStore parameters [#128759997]
* Upgraded DSS version to 4.7.RC2 [#130362923]
* Fixed including OCSP revocation errors in DSS simple report [#129526189]


Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 6
--------------------
Changes
-------
* Fix: Timestamp will not be taken when extending signatures from B_EPES to LT_TM [#132313731]

Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 5
--------------------
Changes
-------
* Fix: XAdES xml tag is added to the newly created signature and existing signatures are not changed [#132151975]

Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 4
--------------------
Changes
-------
* Fixed opening xades signatures without xml preamble [#131795201]

Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 3
--------------------
Changes
-------
* Implemented parallel validation of signatures in a container [#113606559]
* Upgraded DSS version to 4.7.RC2 [#130362923]

Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 2
--------------------
Changes
-------
* Added support for extending EPES signature to LT_TM profile [#130718495]
* Added support for CVC concatenated signature format for ECDSA signatures [#121930867]
* Added support for automatically determining if ECC signature algorithm [#121839585]
* Fixed including OCSP revocation errors in DSS simple report [#129526189]

Known issues
------------
* German and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.5 Beta 1
--------------------
Changes
-------
* Added support for setting SSL KeyStore and TrustStore parameters [#128759997]
* Improved OCSP request failure message with a link to the wiki Q&A section
* Fixed closing serialization streams

Known issues
------------
* German, Norwegian and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113](https://www.pivotaltracker.com/story/show/118940113)
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.4
--------------------
Summary of the major changes since 1.0.3
----------------------------------------
* Added support for filtering trusted territories being loaded from TSL [#109348844]
* Added support for PKCS#11 (Smart Cards, Hardware tokens) [#74204066]
* Added support for adding complete AdES (Raw) signature to a container [#74203228]
* Added network proxy configuration for http, https and basic authentication [#116952041]
* Added support for signing multiple files with the command line util tool [#118916203]
* Added support for B_EPES signature profile [#120656717]
* Updated DSS version to 4.7.RC1 [#119363039]
* Excluded logback dependency from built JAR [#118379881]

Known issues
------------
* German, Norwegian and Croatian TSL are being ignored for not being compliant.
* XML validation report has issues [#118940113]
* Validating old DDoc v1.0 signatures may have exceptions for having incompatible OCSP response.
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.4 Beta 3
--------------------
Changes
-------
* Added support for PKCS#11 (Smart Cards, Hardware tokens) #74204066
* Added support for signing multiple files with the command line util tool #118916203
* Added support for B_EPES signature profile #120656717
* Updated PKCS#11 signing example #116207301
* Fixed getting OCSP certificate when TSL was not loaded #121052217

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.4 Beta 2
--------------------
Changes
-------
* Added network proxy configuration for http, https and basic authentication [#116952041]

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.4 Beta 1
--------------------
Changes
-------
* Improved META-INF/*signatures*.xml file recognition [#118473567]
* Excluded logback dependency from built JAR [#118379881]
* Implemented adding complete AdES (Raw) signature to a container [#74203228]
* Improved signature type differentiation between BDoc-TM and TS [#118546083]
* Improved TSLCertificateSource.addTSLCertificate() according to new TSL standard [#109952664]
* Added load testing of signature creation and validation speed [#112669283]
* Fixed parsing bdoc-tm policy identifier

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)


Release 1.0.3
--------------------
Summary of the major changes since 1.0.2
----------------------------------------
* Improved TSL loading and cache renewal (incl. lazy loading)
* Added support for Trusted List version 5 [#118240769]
* Data files are stored on memory with an option to store them as temporary files on disk [#80897454] [#80897454]
* Added recognition of Estonian older generation cards by using TokenAlgorithmSupport.determineSignatureDigestAlgorithm(X509Certificate certificate) [#101576478]
* Updated DSS to version 4.6 [#111596844]
* Fixed serialization [#116698977] [#117811871]
* Fixed ESTEID-SK 2015 certificate issues [#117057181]
* Fixed bugs


Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* 1 unit test is temporarily failing


Release 1.0.3 RC2 (Release Candidate)
--------------------
Changes
-------
* Fixed validating container data file names with signature references
* Excluded logback.xml file from the built jar file. It is included in the utility zip file, possibility to manage util logs [#118379881]


Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* 1 unit test is temporarily failing


Release 1.0.3 RC (Release Candidate)
--------------------
Changes
-------
* Fixed RESPONDER_CERT id attribute for OCSP certificates in signatures.xml file [#117057181]
* Fixed BDoc validation when opening serialized container [#117811871]
* Added UTF-8 as the ASIC container character encoding [#116681705]
* Added support for Trusted List version 5 (ETSI TS 119 612 v2.1.1) [#118240769]
* Improved error log when TSL loading fails
* Changed configuration so that signing OCSP requests is disabled by default in PROD (access certificate configuration is not set by default)


Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* 1 unit test is temporarily failing


Release 1.0.3 Beta 3
--------------------
Changes
-------
* Implemented cloning TSL for each signature creation and validation process [#117125475]
* Fixed serialization when opening existing containers [#116698977]
* Fixed getting signing certificate subject name [#115939015]
* Removed creation of digidoc4j.log file on disk [#116690151]
* Removed the requirement for configuring CA certs in yaml configuration for BDoc containers [#116690651]


Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* 1 unit test is temporarily failing


Release 1.0.3 Beta 2
--------------------
Changes
-------
* Implemented automatic renewal of TSL cache [#116461557]
* Implemented lazy TSL loading to speed up container opening when TSL is not needed [#114470853]


Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* 1 unit test is temporarily failing


Release 1.0.3 Beta 1
--------------------
Changes
-------
* Published version 1.0.2 to the Maven Central [#101127396]
* Merged DSS to version 4.6 [#111596844]
* Added recognition of Estonian older generation cards by using TokenAlgorithmSupport.determineSignatureDigestAlgorithm(X509Certificate certificate) [#101576478]
* Data files are stored only in memory by default [#80897454]
* Added an option to store data files as temporary files on disk [#80897454]
 * by using DIGIDOC_MAX_DATAFILE_CACHED parameter when opening containers and
 * by using LargeDataFile object when adding data files to a container
* Updated commons-collections to version 3.2.2
* Removed redundant dss-asic and dss-cades dependencies

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* When opening an existing DDoc container with DIGIDOC_MAX_DATAFILE_CACHED value set as 0, then everything is stored in memory. Data files should be stored on disk instead (a bug in jDigidoc)
* BES signature validation fails (reportedly no revocation data found)
* 2 unit tests are temporarily failing (mostly covering the known issues)


Release 1.0.2
--------------------
Summary of the major changes since 1.0.1
----------------------------------------
* Improved TSL loading time
* Improved performance on opening and validating BDoc containers [#94193396]
* Added support for creating multiple signatures in parallel and adding to the container later [#101575340]
* Added support for saving and opening containers without signatures [#74201980]
* Moved BDoc container handling from DSS to DigiDoc4j [#111598972]
* DSS signing library version was updated to 4.6.RC1 [#100649370]
* The old deprecated API is no longer supported by BDoc containers
* The more detailed changelog is available with the beta releases

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* BES signature validation fails (reportedly no revocation data found)
* 2 unit tests are temporarily failing (mostly covering the known issues)


Release 1.0.2 RC
--------------------
Changes
-------
* Renewed jdigidoc library to version 3.12.0 (for DDoc containers) [#105559614]
* Added support for the new Esteid CA (for DDoc) [#109958064]
* Added the new EU TSL signing certificates to the keychain [#112406999]
* Removed the old TSL signing certificates [#108620136]
* Optimized signature validation speed by using singelton Configuration objects [#94193396]
* Fixed generating random nonce for OCSP request for TS signature [#85883082]
* Fixed async signing and serialization [#112048907]
* Changed the default test TSL in TEST mode to demo.sk.ee [#112048093]
* Fixed validation of a different manifest XML namespace in manifest.xml file [#105651692]
* Added validation for not allowing signatures with CRLs to be valid [#105740878]
* Fixed opening containers with BOM symbols in mimetype files [#105652644]
* Fixed an exception when getting an invalid ocsp response [#111946527]

Known issues
------------
* Adding a raw signature to a DDoc container and then saving the container produces an error (a bug in jDigidoc version 3.12.0)
* BES signature validation fails (reportedly no revocation data found)
* 2 unit tests are temporarily failing (mostly covering the known issues)


Release 1.0.2 Beta 3
--------------------
Changes
-----------
* Finished moving Asic-e container manipulation from DSS to DigiDoc4j [#111598972]
* Many of the old deprecated API methods are not supported by BDoc functionality
* Improved the performance of opening and validating BDoc containers
* Default signature id is randomly generated (setting ID manually is still possible)
* Fixed setting BDoc validation warnings
* Solved the known issues reported in 1.0.2 Beta 2

Known issues
------------
* European TSL validation is failing [#112406999]
* 3 unit tests are temporarily failing (mostly covering the known issues)


Release 1.0.2 Beta 2
--------------------
Changes
-----------
* Moved Asic-e container manipulation from DSS to DigiDoc4j [#111598972]
* Added support for saving and opening containers without signatures [#74201980]
* Added support for setting signature encryption algorithm (e.g. ECC) in the signature builder [#110239246]
* The library version information is added for each file within the BDoc container as a zip comment [#74203294]
* Optimized the speed of signature creation [#84912270]
* Signatures can be created in parallel and added to the container later [#101575340]
* Fixed tsl scheme territory

Known issues
------------
* Serializing BDoc containers is not supported
* Extending BDoc container signature profile is not supported fully
* BDoc container validation report in XML format is not available
* The BDoc container is created from the scratch when saving an existing container (instead of just adding the newly added signature to the existing container)
* Default signature id is randomly generated by DSS (probably not a bug but a feature)
* European TSL validation is failing [#112406999]
* 22 unit tests are temporarily failing (mostly covering the known issues)

Release 1.0.2 Beta 1
--------------------
Changes
-------
- Fixed an error when OCSP response was missing
- Fixed handling OCSP revocation when reason is not given
- Fixed getting signature profile correctly for BDoc-TM signatures #104878462, #84684252
- Fixed TSL loading for test certificates - using country scheme 'EE' instead of 'EU'
- Fixed some unit tests
- Added missing dependency to the utility jar

Known issues
------------
- 2 unit tests are temporarily failing

Release 1.0.2 Alpha2
--------------------
Changes
-------
- Fixed 4.6RC1 upgrade problems #100649370
- Added validation if OCSP response is included after signing
- Validating BDoc-TM OCSP nonce
- BDoc-TM signatures without timestamp are also considered to have XAdES_BASELINE_LT level
- Validating OCSP production time and timestamp delta
- Adding library version as zip comment on BDoc containers
- Parsing BDoc manifest file
- Setting TSL socket timeout and handling LOTL loading exception
- Fixed signing with ecc signatures

Known issues
------------
- BDoc validation may not find all the errors
- 3 unit tests are temporarily failing
- Norwegian TSL can not be validated successfully

Release 1.0.2 Alpha1
--------------------
Changes
-------

- Upgraded DSS to version 4.6RC1 #100649370

Known issues
------------
- BDoc validation does not find all the errors
- BDoc container is missing zip comment with version info
- Not possible to sign with ECC certificate
- Clearing TSL cache does not work
- 35 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC
- Norwegian TSL can not be validated successfully

Release 1.0.1 BETA1
-------------------
Changes
-------
- Fixed: BDoc signing should fail when OCSP response is not received #108065658
- Fixed showing correct library version in OCSP and Timestamp request headers #107212346
- Added showing version information with the utility tool #107212346
- Added data file extraction to the utility program #108605834
- Confirmed Canonical XML v1.1 support #74213104

Known issues
------------
- 2 unit tests are temporarily failing
- Norwegian TSL can not be validated successfully
- Validation of signatures with older Estonian ID-card certificates produces warning: "The certificate is not qualified!" #105471148


Release 1.0.0
-------------------
Changes
-------
- Fixed forwarding OCSP signing configuration values to jdigidoc (DDoc containers) #108021558
- Hiding bloated TSL validation errors (Norwegian TSL is invalid) #108066580
- Fixed loading TSL validation keystore from a jar file.


Known issues
------------
- 2 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC
- Norwegian TSL can not be validated successfully
- Validation of signatures with older Estonian ID-card certificates produces warning: "The certificate is not qualified!" #105471148


Release 1.0.0.RC
-------------------
Changes
-------
- Fixed checking certificate validation when the signer's certificate is expired at the signing time (#86092592, #98721424)
- Added TSL signature validation (#98727714)
- Added possibility to enable/disable OCSP request signing


Known issues
------------
- 2 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC
- Norwegian TSL can not be validated successfully


Release 0.3.0 BETA6
-------------------
Changes
-------
- Added validation for checking if signature timestamp certificate is in TSL #83689768
- Generating nonce as "non-critical" in OCSP request for TS signature #105450476
- Made DDocContainer configuration thread safe #86696334
- Updated test TSL for a new one #101881124
- Fixed RSA signature digest algorithm prefixes #101138690
- Made logger declarations consistent
- Fixed signing existing DDoc container with the utility tool

Known issues
------------
- 2 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC


Release 0.3.0 BETA5
-------------------
Changes
-------
- Added validation for matching time-stamp with signature #98722280
- Added validation for the case when two data files are with same name and only one is signed #105211272
- Added including OCSP confirmation for DDoc LT_TM signatures #103395848
- Added validation check that OCSP response should be after time-stamp for BDoc containers #84683484
- Fixed removing signatures from the container #91601974
- Extracted BDoc container validation code into smaller classes.
- Fixed couple of failing unit tests

Known issues
------------
- 2 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC


Release 0.3.0 BETA4
-------------------
Changes
-------
- Updated Javadoc according to the new API [#103766598]
- Added validation support for RSA 2047 bit keys [#100938144]
- Fixed duplicate signature xml file exception when adding signatures to jDigiDoc container [#105288968]
- Renamed Signature.getRawSignature to getAdESSignature
- Improved logging
- Improved handling of empty OCSP response

Known issues
------------
- 7 unit tests are temporarily failing
- Many of the DSS unit tests are broken because OCSP response is required in BDOC
- DigiDoc4j UriEncodingTest and MultiSignatureThreadSafetyTest are broken because test signing certificate is expired


Release 0.3.0 BETA3
-------------------
Changes
-------
Fixed NullPointerException that occurred on DDoc containers when SignatureProductionPlace data was not provided
API improvements #102993198
- Container builder accepts DataFile objects
- Deleted DigestInfoPrefix class, moved prefixes to DigestAlgorithm enum
- Removed Container dependency from SignatureParameters class.
- Renamed Signature.getSigningTime to getClaimedSigningTime
- Renamed SignatureBuilder.withDigestAlgorithm to withSignatureDigestAlgorithm
- Removed Validating signature by validation type - Signature.validate(Validate validationType)
- Removed Signature.setCertificate
- Removed getting private key from signature token
- Added getting trusted signing time to the Signature interface

Known issues
------------
7 unit tests are temporarily failing
Many of the DSS unit tests are broken because OCSP response is required in BDOC
DigiDoc4j UriEncodingTest and MultiSignatureThreadSafetyTest are broken because test signing certificate is expired
------------------------------------


Release 0.3.0 BETA2
-------------------
Changes
-------
The new API is more backward compatible with the old API. Creating and opening containers is not backward compatible.
Added support for adding new container implementations in runtime
Changed test OCSP url
Updated unit tests with the new API
Reduced unnecessary logging a little bit

Known issues
------------
7 unit tests are temporarily failing
Many of the DSS unit tests are broken because OCSP response is required in BDOC
DigiDoc4j UriEncodingTest and MultiSignatureThreadSafetyTest are broken because test signing certificate is expired


Release 0.3.0 BETA
------------------
Changes
-------
Refactored API interface #102001330
Restored Logback logger configuration xml file #100946538
Fixed the bug when data files go missing in action when container contains more than two data files #100660808

Known issues
------------
API is not backwards compatible. Using it requires some changes to code.
9 unit tests are temporarily failing
Many of the DSS unit tests are broken because OCSP response is required in BDOC
DigiDoc4j UriEncodingTest and MultiSignatureThreadSafetyTest are broken because test signing certificate is expired


Release 0.2.20 BETA2
--------------------
Changes
-------
Fixed the interoperability problem with jDigiDoc: OSCP certificate tag has RESPONDER_CERT id
Included Nortal DDS team pull request to DSS and DigiDoc4j. Updated DSS libraries

Known issues
-------------
Many of the DSS unit tests are broken because OCSP response is required in BDOC
DigiDoc4j UriEncodingTest and MultiSignatureThreadSafetyTest are broken because test signing certificate is expired
IntelliJ IDEA project files are out of sync
Some files (DSSSignedInfo.java and DSSXMLSignature.java) were leftover after merging the pull request with DSS refactered code. Hopefully nobody will miss them
Interoperability with JDigiDoc: BDOC-TM (time-mark) files created with DigiDoc4j library can be validated with JDigiDoc version 3.10 or newer.


Release 0.2.20 BETA
-------------------
Changes
-------
DSS has been updated to version 4.4.RC1
DSS did a major refactoring of modules and some changes to API
Fixed unit tests and code that broke because of DSS rafactoring

Known issues
------------
Interoperability problems with jDigiDoc:
- OSCP certificate tag is missing RESPONDER_CERT id in signatures.xml file when BDOC is created with DigiDoc4j, but jDigiDoc requires that ID to be present. Note that RESPONDER_CERT id is not required by the BDOC standard.
- BDOC-TM (time-mark) files created with DigiDoc4j library can be validated with JDigiDoc version 3.10 or newer.


Release 0.2.18
---------------
New
---
It is possible to set TSL loading connection timeout
Signing certificate digest method is SHA256 instead SHA1
Generates random nonce for OCSP request for TS signature

Fixes
------
Bad error message (No revocation data for the certificate) for revoked OCSP replaced with "The certificate is revoked"
Now is restricted to add 2 data files with same name from stream.

Known issues
-------------
Interoperability with JDigiDoc: BDOC-TM (time-mark) files created with DigiDoc4j library can be validated with JDigiDoc version 3.10 or newer.


Release 0.2.17
---------------
New
----
Verifies that the signature contains one signed properties reference
Supports signing with ECC signature

Fixes
------
Signer's certificate validity now checked at OCSP response's produced at time
Revoked certificate now returns correct error message

Known issues
------------
Interoperability with JDigiDoc: BDOC-TM (time-mark) files created with DigiDoc4j library can be validated with JDigiDoc version 3.10 or newer.


Release 0.2.16 
---------------------
- Support for handling ASiC-E XAdES (BDOC 2.1) digital signatures with time-stamps (denoted as LT level) and time-marks (denoted as LT-TM level).
- Support for handling DDOC (DIGIDOC-XML 1.3) digital signature formats. 
- Support for using TSL (Trust service Status Lists) for obtaining trust anchor information.
- Possibility to create signatures with PKCS#12 tokens and add signature values that are calculated in external systems. e.g. via browser plug-in. 
- Support for using RSA algorithm for cryptographic operations. ECDSA algorithm support will be added with the next iterations.
- ASiC-E LT-TM signatures (BDOC 2.1 with time-mark) that are created with DigiDoc4J library are not compatible with JDigiDoc library's versions 3.9 and earlier.
- Information about further developments can be found from Pivotal: https://www.pivotaltracker.com/n/projects/1110130. The library's API may be changed in the course of future developments according to feedback from users. 
